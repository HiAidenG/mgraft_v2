name: cas_systems
description: CRISPR-associated protein systems from DefenseFinder
version: "1.0"

columns:
  genome_id:
    type: string
    required: true

  feature_type:
    type: string
    required: true
    enum: [Cas_system]

  ID:
    type: string
    required: true
    pattern: "^{genome_id}__CAS\\d{4}$"

  contig:
    type: string
    required: true

  start:
    type: integer
    required: true
    min: 1

  end:
    type: integer
    required: true
    min: 1

  strand:
    type: string
    required: true
    enum: ["+", "-", "."]

  cas_class:
    type: string
    required: false
    enum: ["Class 1", "Class 2"]
    description: CRISPR-Cas class

  cas_subtype:
    type: string
    required: false
    description: "e.g., Type I-E, Type II-A"

  sys_wholeness:
    type: float
    required: true
    min: 0
    max: 1
    description: Fraction of expected genes present (1.0 = complete)

  n_genes:
    type: integer
    required: true
    min: 1

derived_columns:
  linked_array_ids:
    added_by: 02_array_cas_linking
    description: Comma-separated list of linked array IDs

  n_linked_arrays:
    added_by: 02_array_cas_linking
    type: integer

  mge_id:
    added_by: 08_mge_overlap
    description: ID of overlapping MGE (NULL if on chromosome)

  mobility_score:
    added_by: 08_mge_overlap
    type: float
    min: 0
    max: 1
    description: Highest fraction of system genes on any single MGE
